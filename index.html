<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cr√©ateur de Prompts IA</title>
    <style>
        /* Reset et base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .app {
            display: flex;
            height: 100vh;
            background: white;
            margin: 20px;
            border-radius: 12px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: linear-gradient(180deg, #f8fafc 0%, #e2e8f0 100%);
            border-right: 1px solid #e2e8f0;
            padding: 20px;
            overflow-y: auto;
        }

        .sidebar h2 {
            color: #1e293b;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: 600;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            margin-bottom: 8px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            background: transparent;
            border: none;
            width: 100%;
            text-align: left;
            font-size: 14px;
            color: #64748b;
        }

        .nav-item:hover {
            background: white;
            color: #1e293b;
            transform: translateX(4px);
        }

        .nav-item.active {
            background: #3b82f6;
            color: white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .nav-icon {
            margin-right: 12px;
            font-size: 16px;
        }

        /* Main content */
        .main-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            background: #fafbfc;
        }

        .page-header {
            margin-bottom: 30px;
        }

        .page-title {
            font-size: 28px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 8px;
        }

        .page-subtitle {
            color: #64748b;
            font-size: 16px;
        }

        /* Wizard Steps */
        .wizard-container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.05);
        }

        .steps-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
            position: relative;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            position: relative;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e2e8f0;
            color: #64748b;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-bottom: 8px;
            transition: all 0.3s;
        }

        .step.active .step-number {
            background: #3b82f6;
            color: white;
            transform: scale(1.1);
        }

        .step.completed .step-number {
            background: #10b981;
            color: white;
        }

        .step-label {
            font-size: 12px;
            color: #64748b;
            text-align: center;
            max-width: 80px;
        }

        /* Form styles */
        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s;
            background: white;
            font-family: inherit;
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .button-group {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 30px;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            font-size: 14px;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
            transform: translateY(-1px);
        }

        .btn-primary:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        /* Quality Analyzer */
        .quality-analyzer {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 1px solid #0ea5e9;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .quality-score {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }

        .score-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 18px;
            margin-right: 16px;
            color: white;
        }

        .score-excellent { background: #10b981; }
        .score-good { background: #3b82f6; }
        .score-average { background: #f59e0b; }
        .score-poor { background: #ef4444; }

        .suggestions-list {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .suggestion-item {
            padding: 8px 0;
            color: #0c4a6e;
            font-size: 14px;
            display: flex;
            align-items: flex-start;
        }

        .suggestion-item::before {
            content: 'üí°';
            margin-right: 8px;
            margin-top: 2px;
        }

        /* Hidden sections */
        .hidden {
            display: none;
        }

        /* Stats box */
        .stats-box {
            margin-top: 32px;
            padding: 16px;
            background: #f1f5f9;
            border-radius: 8px;
            font-size: 14px;
        }

        .stats-box h4 {
            margin: 0 0 8px 0;
            font-size: 14px;
        }

        .stats-box p {
            margin: 0;
            color: #64748b;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .app {
                margin: 0;
                border-radius: 0;
                flex-direction: column;
                height: 100vh;
            }

            .sidebar {
                width: 100%;
                height: auto;
                order: 2;
            }

            .main-content {
                order: 1;
                flex: 1;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="app">
        <div class="sidebar">
            <h2>Cr√©ateur de Prompts IA</h2>
            
            <button class="nav-item active" data-tab="creator">
                <span class="nav-icon">üöÄ</span>
                Assistant de Cr√©ation
            </button>

            <!-- NOUVEAU: Bouton pour la biblioth√®que de prompts -->
            <button class="nav-item" data-tab="library">
                <span class="nav-icon">üìö</span>
                Mes Prompts
            </button>
            
            <button class="nav-item" data-tab="help">
                <span class="nav-icon">‚ùì</span>
                Guide d'utilisation
            </button>
            
            <div class="stats-box">
                <h4>üìä Vos prompts</h4>
                <p id="prompt-count">0 prompt sauvegard√©</p>
            </div>
        </div>
        
        <div class="main-content">
            <!-- Section Assistant de Cr√©ation -->
            <div id="creator-section">
                <div class="page-header">
                    <h1 class="page-title">Assistant de Cr√©ation de Prompts</h1>
                    <p class="page-subtitle">Cr√©ez des prompts efficaces √©tape par √©tape</p>
                </div>
                
                <div class="wizard-container">
                    <div class="steps-indicator">
                        <div class="step active" data-step="0">
                            <div class="step-number">1</div>
                            <div class="step-label">R√¥le</div>
                        </div>
                        <div class="step" data-step="1">
                            <div class="step-number">2</div>
                            <div class="step-label">Objectif</div>
                        </div>
                        <div class="step" data-step="2">
                            <div class="step-number">3</div>
                            <div class="step-label">Contexte</div>
                        </div>
                        <div class="step" data-step="3">
                            <div class="step-number">4</div>
                            <div class="step-label">Structure</div>
                        </div>
                        <div class="step" data-step="4">
                            <div class="step-number">5</div>
                            <div class="step-label">Exemples</div>
                        </div>
                        <div class="step" data-step="5">
                            <div class="step-number">6</div>
                            <div class="step-label">Contraintes</div>
                        </div>
                    </div>

                    <h3 id="step-title">Quel r√¥le doit jouer l'IA ?</h3>

                    <!-- √âtape 1: R√¥le de l'IA -->
                    <div id="step-0" class="step-content">
                        <div class="form-group">
                            <label class="form-label">Quel r√¥le doit jouer l'IA ?</label>
                            <textarea 
                                id="role" 
                                class="form-textarea" 
                                placeholder="Ex: Tu es un expert d√©veloppeur Python avec 10 ans d'exp√©rience en algorithmes..."
                            ></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">R√¥les sugg√©r√©s</label>
                            <select id="role-suggestions" class="form-select">
                                <option value="">Choisir un r√¥le pr√©d√©fini (optionnel)</option>
                                <option value="expert-dev">Expert d√©veloppeur</option>
                                <option value="consultant">Consultant en strat√©gie</option>
                                <option value="professeur">Professeur p√©dagogue</option>
                                <option value="redacteur">R√©dacteur professionnel</option>
                                <option value="analyste">Analyste de donn√©es</option>
                                <option value="coach">Coach personnel</option>
                                <option value="designer">Designer UX/UI</option>
                                <option value="traducteur">Traducteur expert</option>
                            </select>
                        </div>
                    </div>

                    <!-- √âtape 2: Objectif -->
                    <div id="step-1" class="step-content hidden">
                        <div class="form-group">
                            <label class="form-label">Que voulez-vous que l'IA fasse ?</label>
                            <textarea 
                                id="objective" 
                                class="form-textarea" 
                                placeholder="Ex: Je veux que tu cr√©es une fonction Python pour calculer la factorielle d'un nombre..."
                            ></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Cat√©gorie</label>
                            <select id="category" class="form-select">
                                <option value="g√©n√©ral">G√©n√©ral</option>
                                <option value="code">Programmation</option>
                                <option value="r√©daction">R√©daction</option>
                                <option value="analyse">Analyse</option>
                                <option value="cr√©atif">Cr√©atif</option>
                            </select>
                        </div>
                    </div>

                    <!-- √âtape 3: Contexte -->
                    <div id="step-2" class="step-content hidden">
                        <div class="form-group">
                            <label class="form-label">D√©crivez le contexte et les informations importantes</label>
                            <textarea 
                                id="context" 
                                class="form-textarea" 
                                placeholder="Ex: Je travaille sur un projet de gestion d'inventaire pour une petite entreprise. L'application doit √™tre simple d'utilisation..."
                            ></textarea>
                        </div>
                    </div>

                    <!-- √âtape 4: Structure -->
                    <div id="step-3" class="step-content hidden">
                        <div class="form-group">
                            <label class="form-label">Comment voulez-vous que la r√©ponse soit structur√©e ?</label>
                            <textarea 
                                id="structure" 
                                class="form-textarea" 
                                placeholder="Ex: Code comment√©, puis explication des algorithmes utilis√©s, puis exemples d'utilisation..."
                            ></textarea>
                        </div>
                    </div>

                    <!-- √âtape 5: Exemples -->
                    <div id="step-4" class="step-content hidden">
                        <div class="form-group">
                            <label class="form-label">Avez-vous des exemples √† fournir ? (Optionnel)</label>
                            <textarea 
                                id="examples" 
                                class="form-textarea" 
                                placeholder="Ex: factorielle(5) doit retourner 120, factorielle(0) doit retourner 1..."
                            ></textarea>
                        </div>
                    </div>

                    <!-- √âtape 6: Contraintes -->
                    <div id="step-5" class="step-content hidden">
                        <div class="form-group">
                            <label class="form-label">Y a-t-il des contraintes sp√©cifiques ? (Optionnel)</label>
                            <textarea 
                                id="constraints" 
                                class="form-textarea" 
                                placeholder="Ex: Utiliser uniquement les biblioth√®ques standard, optimiser pour la performance, code compatible Python 3.8+..."
                            ></textarea>
                        </div>
                    </div>

                    <!-- Analyseur de qualit√© -->
                    <div id="quality-analyzer" class="quality-analyzer hidden">
                        <div class="quality-score">
                            <div id="score-circle" class="score-circle score-poor">0/5</div>
                            <div>
                                <h4 id="score-label">Qualit√© : √Ä am√©liorer</h4>
                                <p>Votre prompt est analys√© en temps r√©el</p>
                            </div>
                        </div>
                        <div id="suggestions-container" class="hidden">
                            <h5>Suggestions d'am√©lioration :</h5>
                            <ul id="suggestions-list" class="suggestions-list"></ul>
                        </div>
                    </div>

                    <div class="button-group">
                        <button id="prev-btn" class="btn btn-secondary hidden">Pr√©c√©dent</button>
                        <button id="next-btn" class="btn btn-primary" disabled>Suivant</button>
                    </div>
                </div>
            </div>

            <!-- NOUVEAU: Section Biblioth√®que de Prompts -->
            <div id="library-section" class="hidden">
                <div class="page-header">
                    <h1 class="page-title">Mes Prompts Sauvegard√©s</h1>
                    <p class="page-subtitle">G√©rez, recherchez et r√©utilisez vos prompts</p>
                </div>
                <div class="wizard-container">
                    <div class="library-controls" style="display: flex; gap: 16px; margin-bottom: 24px;">
                        <input type="text" id="search-input" class="form-input" placeholder="Rechercher un prompt..." style="flex-grow: 1;">
                        <select id="sort-select" class="form-select" style="width: 200px;">
                            <option value="newest">Plus r√©cents d'abord</option>
                            <option value="oldest">Plus anciens d'abord</option>
                            <option value="title-asc">Titre (A-Z)</option>
                            <option value="title-desc">Titre (Z-A)</option>
                        </select>
                    </div>
                    <div id="prompt-library-list">
                        <!-- Les prompts seront inject√©s ici par JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Section Aide -->
            <div id="help-section" class="hidden">
                <div class="page-header">
                    <h2 class="page-title">Guide d'utilisation</h2>
                    <p class="page-subtitle">Comment cr√©er des prompts efficaces</p>
                </div>
                <div class="wizard-container">
                    <h3>Comment utiliser l'assistant ?</h3>
                    <p style="margin-bottom: 16px;"><strong>1. D√©finissez le r√¥le de l'IA :</strong> Commencez par "Tu es un expert en..." pour donner un contexte professionnel.</p>
                    <p style="margin-bottom: 16px;"><strong>2. Pr√©cisez votre objectif :</strong> Que voulez-vous que l'IA fasse exactement ?</p>
                    <p style="margin-bottom: 16px;"><strong>3. Fournissez le contexte :</strong> Plus l'IA comprend votre situation, mieux elle peut vous aider.</p>
                    <p style="margin-bottom: 16px;"><strong>4. Sp√©cifiez la structure :</strong> Comment voulez-vous que la r√©ponse soit organis√©e ?</p>
                    <p style="margin-bottom: 16px;"><strong>5. Donnez des exemples :</strong> Montrez ce que vous attendez avec des exemples concrets.</p>
                    <p style="margin-bottom: 32px;"><strong>6. Ajoutez des contraintes :</strong> Pr√©cisez les limites et exigences techniques.</p>
                    
                    <h3 style="margin-bottom: 16px;">Conseils pour de meilleurs prompts</h3>
                    <p style="margin-bottom: 8px;">‚Ä¢ <strong>Commencez toujours par un r√¥le</strong> - "Tu es un expert en..."</p>
                    <p style="margin-bottom: 8px;">‚Ä¢ Soyez sp√©cifique plut√¥t que vague</p>
                    <p style="margin-bottom: 8px;">‚Ä¢ Utilisez des exemples concrets</p>
                    <p style="margin-bottom: 8px;">‚Ä¢ Structurez votre demande en √©tapes</p>
                    <p style="margin-bottom: 8px;">‚Ä¢ Pr√©cisez le format de r√©ponse souhait√©</p>
                    <p style="margin-bottom: 8px;">‚Ä¢ Testez et affinez vos prompts</p>
                    
                    <div style="margin-top: 32px; padding: 20px; background: #f0f9ff; border-radius: 8px; border: 1px solid #0ea5e9;">
                        <h4 style="margin: 0 0 12px 0; color: #0c4a6e;">üí° Astuce Pro</h4>
                        <p style="margin: 0; color: #0c4a6e;">Un excellent prompt suit la formule <strong>R.O.L.E.</strong> : <strong>R</strong>√¥le, <strong>O</strong>bjectif, <strong>L</strong>imites/contexte, <strong>E</strong>xemples. Cette structure garantit des r√©ponses de qualit√© professionnelle.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Variables globales
        let currentStep = 0;
        let formData = {
            role: '',
            objective: '',
            context: '',
            structure: '',
            examples: '',
            constraints: '',
            category: 'g√©n√©ral'
        };

        const steps = [
            { key: 'role', title: 'Quel r√¥le doit jouer l\'IA ?' },
            { key: 'objective', title: 'Quel est votre objectif ?' },
            { key: 'context', title: 'Quel contexte l\'IA doit-elle conna√Ætre ?' },
            { key: 'structure', title: 'Comment structurer la r√©ponse ?' },
            { key: 'examples', title: 'Avez-vous des exemples ?' },
            { key: 'constraints', title: 'Des contraintes sp√©cifiques ?' }
        ];

        // Utilitaires de stockage
        const storage = {
            savePrompt: function(prompt) {
                const prompts = this.getPrompts();
                const newPrompt = {
                    id: Date.now().toString(),
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString(),
                    rating: 0,
                    usageCount: 0,
                    ...prompt
                };
                prompts.push(newPrompt);
                localStorage.setItem('prompts', JSON.stringify(prompts));
                return newPrompt;
            },

            getPrompts: function() {
                try {
                    return JSON.parse(localStorage.getItem('prompts')) || [];
                } catch {
                    return [];
                }
            },

            // NOUVEAU: Fonction pour supprimer un prompt
            deletePrompt: function(id) {
                let prompts = this.getPrompts();
                prompts = prompts.filter(p => p.id !== id);
                localStorage.setItem('prompts', JSON.stringify(prompts));
            }
        };

        // Analyseur de qualit√©
        function analyzePrompt(prompt) {
            const analysis = {
                score: 0,
                issues: [],
                suggestions: []
            };

            if (!prompt || prompt.trim().length === 0) {
                return { score: 0, issues: ['Prompt vide'], suggestions: ['Commencez par d√©finir un r√¥le pour l\'IA'] };
            }

            let score = 5;

            const hasRole = /\b(tu es|vous √™tes|agis comme|joue le r√¥le|expert|sp√©cialiste|professionnel)\b/i.test(prompt);
            if (!hasRole) {
                analysis.issues.push('Aucun r√¥le d√©fini');
                analysis.suggestions.push('Commencez par "Tu es un expert en..." ou "Agis comme..."');
                score--;
            }

            const hasObjective = /\b(je veux|g√©n√®re|cr√©e|√©cris|analyse|explique|aide|fais|objectif)\b/i.test(prompt);
            if (!hasObjective) {
                analysis.issues.push('Objectif peu clair');
                analysis.suggestions.push('Pr√©cisez clairement ce que vous voulez que l\'IA fasse');
                score--;
            }

            if (prompt.length < 80) {
                analysis.issues.push('Manque de contexte');
                analysis.suggestions.push('Ajoutez plus de d√©tails sur le contexte et vos attentes');
                score--;
            }

            if (prompt.length > 150 && !prompt.includes('\n') && !prompt.includes('.')) {
                analysis.suggestions.push('Structurez avec des sauts de ligne ou des points pour plus de clart√©');
                score -= 0.5;
            }

            const vague = /\b(chose|truc|machin|quelque chose|bien|bon)\b/i.test(prompt);
            if (vague) {
                analysis.issues.push('Termes trop vagues');
                analysis.suggestions.push('Remplacez les termes vagues par des descriptions pr√©cises');
                score--;
            }

            if (hasRole && hasObjective && prompt.length > 100) {
                score += 0.5;
            }

            analysis.score = Math.max(0, Math.min(5, Math.round(score * 10) / 10));
            return analysis;
        }

        // Mise √† jour de l'analyseur de qualit√©
        function updateQualityAnalyzer() {
            const prompt = getPromptPreview();
            if (!prompt) {
                document.getElementById('quality-analyzer').classList.add('hidden');
                return;
            }

            const analysis = analyzePrompt(prompt);
            document.getElementById('quality-analyzer').classList.remove('hidden');

            const scoreCircle = document.getElementById('score-circle');
            const scoreLabel = document.getElementById('score-label');
            
            scoreCircle.textContent = analysis.score + '/5';
            scoreCircle.className = 'score-circle ' + getScoreClass(analysis.score);
            scoreLabel.textContent = 'Qualit√© : ' + getScoreLabel(analysis.score);

            const suggestionsContainer = document.getElementById('suggestions-container');
            const suggestionsList = document.getElementById('suggestions-list');
            
            if (analysis.suggestions.length > 0) {
                suggestionsContainer.classList.remove('hidden');
                suggestionsList.innerHTML = '';
                analysis.suggestions.forEach(suggestion => {
                    const li = document.createElement('li');
                    li.className = 'suggestion-item';
                    li.textContent = suggestion;
                    suggestionsList.appendChild(li);
                });
            } else {
                suggestionsContainer.classList.add('hidden');
            }
        }

        function getScoreClass(score) {
            if (score >= 4.5) return 'score-excellent';
            if (score >= 3.5) return 'score-good';
            if (score >= 2) return 'score-average';
            return 'score-poor';
        }

        function getScoreLabel(score) {
            if (score >= 4.5) return 'Excellent';
            if (score >= 3.5) return 'Bon';
            if (score >= 2) return 'Moyen';
            return '√Ä am√©liorer';
        }

        function getPromptPreview() {
            let preview = '';
            if (formData.role) preview += formData.role + '\n\n';
            if (formData.objective) preview += 'Objectif : ' + formData.objective + '\n\n';
            if (formData.context) preview += 'Contexte: ' + formData.context + '\n\n';
            if (formData.structure) preview += 'Structure: ' + formData.structure + '\n\n';
            if (formData.examples) preview += 'Exemples: ' + formData.examples + '\n\n';
            if (formData.constraints) preview += 'Contraintes: ' + formData.constraints;
            return preview.trim();
        }

        function updateStepDisplay() {
            document.querySelectorAll('.step-content').forEach(step => {
                step.classList.add('hidden');
            });
            document.getElementById(`step-${currentStep}`).classList.remove('hidden');
            document.getElementById('step-title').textContent = steps[currentStep].title;

            document.querySelectorAll('.step').forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index === currentStep) {
                    step.classList.add('active');
                } else if (index < currentStep) {
                    step.classList.add('completed');
                }
            });

            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');

            prevBtn.classList.toggle('hidden', currentStep === 0);
            nextBtn.textContent = (currentStep === steps.length - 1) ? 'Cr√©er le Prompt' : 'Suivant';

            if (currentStep === 0 && !formData.role.trim()) {
                nextBtn.disabled = true;
            } else if (currentStep === 1 && !formData.objective.trim()) {
                nextBtn.disabled = true;
            } else {
                nextBtn.disabled = false;
            }
        }

        function nextStep() {
            if (currentStep < steps.length - 1) {
                currentStep++;
                updateStepDisplay();
            } else {
                generatePrompt();
            }
        }

        function prevStep() {
            if (currentStep > 0) {
                currentStep--;
                updateStepDisplay();
            }
        }

        function generatePrompt() {
            const promptContent = getPromptPreview();
            
            storage.savePrompt({
                title: (formData.objective || 'Nouveau Prompt').substring(0, 40) + '...',
                content: promptContent,
                category: formData.category,
                tags: ['wizard-generated']
            });

            alert('Prompt cr√©√© avec succ√®s !');
            
            resetForm();
            updatePromptCount();
        }

        function resetForm() {
            currentStep = 0;
            formData = { role: '', objective: '', context: '', structure: '', examples: '', constraints: '', category: 'g√©n√©ral' };
            document.getElementById('role').value = '';
            document.getElementById('objective').value = '';
            document.getElementById('context').value = '';
            document.getElementById('structure').value = '';
            document.getElementById('examples').value = '';
            document.getElementById('constraints').value = '';
            document.getElementById('category').value = 'g√©n√©ral';
            document.getElementById('role-suggestions').value = '';
            updateStepDisplay();
            updateQualityAnalyzer();
        }

        function updatePromptCount() {
            const count = storage.getPrompts().length;
            const text = count <= 1 ? `${count} prompt sauvegard√©` : `${count} prompts sauvegard√©s`;
            document.getElementById('prompt-count').textContent = text;
        }

        // MODIFI√â: Gestion de la navigation entre les onglets
        function switchTab(tabName) {
            document.getElementById('creator-section').classList.add('hidden');
            document.getElementById('help-section').classList.add('hidden');
            document.getElementById('library-section').classList.add('hidden');

            document.getElementById(tabName + '-section').classList.remove('hidden');

            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

            // NOUVEAU: Charger la biblioth√®que si l'onglet est s√©lectionn√©
            if (tabName === 'library') {
                renderPromptLibrary();
            }
        }

        // --- NOUVELLES FONCTIONS POUR LA BIBLIOTH√àQUE ---

        function renderPromptLibrary() {
            const listContainer = document.getElementById('prompt-library-list');
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const sortValue = document.getElementById('sort-select').value;

            let prompts = storage.getPrompts();

            // 1. Filtrage
            if (searchTerm) {
                prompts = prompts.filter(p => 
                    p.title.toLowerCase().includes(searchTerm) || 
                    p.content.toLowerCase().includes(searchTerm)
                );
            }

            // 2. Tri
            prompts.sort((a, b) => {
                switch (sortValue) {
                    case 'oldest':
                        return new Date(a.createdAt) - new Date(b.createdAt);
                    case 'title-asc':
                        return a.title.localeCompare(b.title);
                    case 'title-desc':
                        return b.title.localeCompare(a.title);
                    case 'newest':
                    default:
                        return new Date(b.createdAt) - new Date(a.createdAt);
                }
            });

            // 3. Rendu
            listContainer.innerHTML = '';
            if (prompts.length === 0) {
                listContainer.innerHTML = '<p style="text-align: center; color: #64748b; padding: 40px 0;">Aucun prompt trouv√©.</p>';
                return;
            }

            prompts.forEach(prompt => {
                const card = document.createElement('div');
                card.className = 'prompt-card';
                card.style = 'background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 16px; margin-bottom: 16px;';
                
                card.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                        <h4 style="margin: 0 0 8px 0; color: #1e293b;">${prompt.title}</h4>
                        <span style="font-size: 12px; color: #64748b; background: #e2e8f0; padding: 4px 8px; border-radius: 12px;">${prompt.category}</span>
                    </div>
                    <p style="font-size: 14px; color: #475569; margin-bottom: 16px; white-space: pre-wrap; max-height: 100px; overflow: hidden; text-overflow: ellipsis;">${prompt.content}</p>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <small style="color: #64748b;">Cr√©√© le: ${new Date(prompt.createdAt).toLocaleDateString('fr-FR')}</small>
                        <div>
                            <button class="btn btn-secondary btn-sm" data-action="copy" data-id="${prompt.id}">Copier</button>
                            <button class="btn btn-danger btn-sm" data-action="delete" data-id="${prompt.id}" style="background-color: #ef4444; color: white;">Supprimer</button>
                        </div>
                    </div>
                `;
                listContainer.appendChild(card);
            });
        }

        function setupLibraryEventListeners() {
            document.getElementById('search-input').addEventListener('input', renderPromptLibrary);
            document.getElementById('sort-select').addEventListener('change', renderPromptLibrary);

            document.getElementById('prompt-library-list').addEventListener('click', (e) => {
                const target = e.target.closest('button');
                if (!target) return;

                const action = target.dataset.action;
                const id = target.dataset.id;

                if (action === 'delete') {
                    if (confirm('√ätes-vous s√ªr de vouloir supprimer ce prompt ?')) {
                        storage.deletePrompt(id);
                        updatePromptCount();
                        renderPromptLibrary();
                    }
                }

                if (action === 'copy') {
                    const prompt = storage.getPrompts().find(p => p.id === id);
                    if (prompt) {
                        navigator.clipboard.writeText(prompt.content).then(() => {
                            alert('Prompt copi√© dans le presse-papiers !');
                        });
                    }
                }
            });
        }


        // Initialisation au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            const predefinedRoles = {
                'expert-dev': 'Tu es un expert d√©veloppeur avec 10+ ans d\'exp√©rience en programmation. Tu ma√Ætrises les bonnes pratiques, l\'architecture logicielle et l\'optimisation de code.',
                'consultant': 'Tu es un consultant en strat√©gie d\'entreprise avec une expertise en transformation digitale et am√©lioration des processus.',
                'professeur': 'Tu es un professeur p√©dagogue qui sait expliquer des concepts complexes de mani√®re simple et accessible, avec des exemples concrets.',
                'redacteur': 'Tu es un r√©dacteur professionnel sp√©cialis√© dans la cr√©ation de contenu engageant, optimis√© SEO et adapt√© √† diff√©rents publics.',
                'analyste': 'Tu es un analyste de donn√©es expert en statistiques, visualisation et interpr√©tation de insights business.',
                'coach': 'Tu es un coach professionnel qui accompagne les individus dans leur d√©veloppement personnel et professionnel.',
                'designer': 'Tu es un designer UX/UI expert en exp√©rience utilisateur, interface intuitive et design thinking.',
                'traducteur': 'Tu es un traducteur professionnel ma√Ætrisant les nuances culturelles et la localisation de contenu.'
            };

            document.getElementById('role').addEventListener('input', function() {
                formData.role = this.value;
                updateQualityAnalyzer();
                updateStepDisplay();
            });

            document.getElementById('role-suggestions').addEventListener('change', function() {
                if (this.value && predefinedRoles[this.value]) {
                    document.getElementById('role').value = predefinedRoles[this.value];
                    formData.role = predefinedRoles[this.value];
                    updateQualityAnalyzer();
                    updateStepDisplay();
                }
            });

            document.getElementById('objective').addEventListener('input', function() {
                formData.objective = this.value;
                updateQualityAnalyzer();
                updateStepDisplay();
            });

            document.getElementById('context').addEventListener('input', function() {
                formData.context = this.value;
                updateQualityAnalyzer();
            });

            document.getElementById('structure').addEventListener('input', function() {
                formData.structure = this.value;
                updateQualityAnalyzer();
            });

            document.getElementById('examples').addEventListener('input', function() {
                formData.examples = this.value;
                updateQualityAnalyzer();
            });

            document.getElementById('constraints').addEventListener('input', function() {
                formData.constraints = this.value;
                updateQualityAnalyzer();
            });

            document.getElementById('category').addEventListener('change', function() {
                formData.category = this.value;
            });

            document.getElementById('next-btn').addEventListener('click', nextStep);
            document.getElementById('prev-btn').addEventListener('click', prevStep);

            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    const tab = this.getAttribute('data-tab');
                    switchTab(tab);
                });
            });

            // NOUVEAU: Initialisation des √©couteurs pour la biblioth√®que
            setupLibraryEventListeners();

            // Initialisation
            updateStepDisplay();
            updatePromptCount();
        });
    </script>
</body>
</html>